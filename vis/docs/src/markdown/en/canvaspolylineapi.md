# CanvasPolylineLayer : CanvasLayer

## Element
`Polyline` is a dmap element designed for `CanvasPolylineLayer`, used for constructing polyline. Its base data structure contains `coordinates` and `options`, indicating coordinate series and polyline style. In this way the layer can render polylines on canvas and supports interactions like clicking.

`Polyline` is generated by `data` method. Its options contains:

| Option | Type | Default | Description |
| :----- | :---:| :-----: | :---------  |
| color | String | `'#000000'` | Polyline color |
| width | Number | `1` | Polyline width in pixel | 
| zoomLevel | Number | `1` | Mininum zoom level to display. Display in all levels for default |

## Parameters

| Option | Type | Default | Description |
| :----- | :---:| :-----: | :---------  |
| opacity | Number | `0.99` | Canvas opacicty |
| createPane | Boolean | `true` | Whether create canvas on a new pane |
| zIndex | Number | `300` | Layer level in Z-axis |
| cursor  | String | `'pointer'` | Mouse CSS style when hovering |
| dividePart  | Number | `2` | Divide polylines by this number to optimize efficiency |


## Methods

### data
*(Array&lt;any&gt;, Function) => this*

Map origin data set to `this._data`, an array of objects with certain keys.

| key    | Type  | Description |
| :----- | :---: | :---------  |
| coordinates  | `Array(Array(2))`/`Array<L.Latlng>` | Polyline coordinate series |
| options | `Object` | Polyline style |

### hide
*() => ()*

Hide this layer and disable all interactions.

### show
*() => ()*

Display this layer and allow all interactions.

### on
*(String event_type, Function callback_function, Object? context) => this*

Bind callback function on this layer.
+ `event_type`: *String*, event
+ `callback_function`: *Function (Polyline p, Number index, Object originData)*, callback function
+ `context`: *Object*, context when calling callback function

### enter
*() => this*

Call `generate` method, map `this._data` to `Polyline` array.

### generate
*() => Array*

Map `this._data` to `Polyline` array.

### addTo
*(Map) => this*

Add this layer on Leaflet `map` container.

### getBounds
*() => L.Bounds*

Return rendering range of this layer. Provide argument for map-scaling functions.

### needRedraw
*() => this*

Force to re-render this layer.


## Demo

We render part of New York City's street data on `CanvasPolylineLayer`. Enable highlighting when clicking and clear when double-clicking.

```javascript
map.doubleClickZoom.disable();

var emphasisList = [];

function emphasisPolyline(polyline) {
    if (polyline.emphasis) return;

    polyline.options.formerColor = polyline.options.color;
    polyline.options.formerWidth = polyline.options.width;

    polyline.options.color = 'red';
    polyline.options.width = 2;

    polyline.emphasis = true;
    emphasisList.push(polyline)
}

function resetEmphasis() {
    emphasisList.forEach(function(polyline) {
        polyline.options.color = polyline.options.formerColor;
        polyline.options.width = polyline.options.formerWidth;
        polyline.emphasis = false;
    });
    emphasisList = [];
}

function onClickCallBack(polyline, index, originData) {
    if (polyline) emphasisPolyline(polyline);
    c.needRedraw();
}

var c = new dmap.CanvasPolylineLayer({
    cursor: 'pointer',
    divideParts: 4
})

 
$.getJSON('nyc.json', function(json) {
    c.data(json.data, function(d) {
        let color = undefined,
            type = parseInt(d.t)
        switch (type) {
            case 2: color = '#f2be45'; break;
            case 3: color = '#ff7500'; break;
            default: color = '#2e4e7e';
        }
        return {
            coordinates: d.c,
            options: { 
                zoomLevel: type == 2 ? 1 : 11,
                color: color,
                width: 0.5
            },
            data: d
        }
    }).enter().addTo(map);
    map.fitBounds(c.getBounds());
    c.on('dblclick', function() {
        resetEmphasis();
    })
    c.on('click', onClickCallBack, c);

})

```